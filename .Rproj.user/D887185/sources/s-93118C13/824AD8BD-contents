library(PopRviz)
context("add layer results")
testObject <- mtcars %>%
  PopRViz() %>%
  addLayer(layerType = 'point',
           layerColor = "blue",
           layerLabel = "testLayer",
           layerMapping = list(x_var = "wt",
                               y_var = "mpg"))

testthat("add layer creates a list of two", {
  expect_output(str(testObject$x$layers), "List of 1")
})

testObject2 <- testObject %>%
  addLayer(layerType = "point",
           layerColor = "red",
           layerData = mtcars,
           layerLabel = "newLayer",
           layerMapping = list(x_var = "drat",
                               y_var = "wt"))

testthat("add layer creates a list of two", {
  expect_output(str(testObject2$x$layers), "List of 2")
})
